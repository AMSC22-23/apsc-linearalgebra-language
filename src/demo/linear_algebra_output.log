===================================================================
=                        FULL MATRIX DEMO                         =
===================================================================
=============== Testing file load and MPI split ===============
loaded full matrix:
[
2, -1, 0, 0, 0, 0, 0, 0, 0, 0,
-1, 2, -1, 0, 0, 0, 0, 0, 0, 0,
0, -1, 2, -1, 0, 0, 0, 0, 0, 0,
0, 0, -1, 2, -1, 0, 0, 0, 0, 0,
0, 0, 0, -1, 2, -1, 0, 0, 0, 0,
0, 0, 0, 0, -1, 2, -1, 0, 0, 0,
0, 0, 0, 0, 0, -1, 2, -1, 0, 0,
0, 0, 0, 0, 0, 0, -1, 2, -1, 0,
0, 0, 0, 0, 0, 0, 0, -1, 2, -1,
0, 0, 0, 0, 0, 0, 0, 0, -1, 2,
]



split matrix over MPI processes:
Process rank=0 Local Matrix=
[
2,
-1,
0,
0,
0,
0,
0,
0,
0,
0,
]
Process rank=1 Local Matrix=
[
-1,
2,
-1,
0,
0,
0,
0,
0,
0,
0,
]
Process rank=2 Local Matrix=
[
0, 0,
-1, 0,
2, -1,
-1, 2,
0, -1,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
]
Process rank=3 Local Matrix=
[
0,
0,
0,
-1,
2,
-1,
0,
0,
0,
0,
]
Process rank=4 Local Matrix=
[
0, 0,
0, 0,
0, 0,
0, 0,
-1, 0,
2, -1,
-1, 2,
0, -1,
0, 0,
0, 0,
]
Process rank=5 Local Matrix=
[
0,
0,
0,
0,
0,
0,
-1,
2,
-1,
0,
]
Process rank=6 Local Matrix=
[
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
-1, 0,
2, -1,
-1, 2,
]



=============== Testing modification ===============
modified full matrix:
[
10, -1, 0, 0, 0, 0, 0, 0, 0, 0,
-1, 2, -1, 0, 0, 0, 0, 0, 0, 0,
0, -1, 2, -1, 0, 0, 0, 0, 0, 0,
0, 0, -1, 2, -1, 0, 0, 0, 0, 0,
0, 0, 0, -1, 2, -1, 0, 0, 0, 0,
0, 0, 0, 0, -1, 2, -1, 0, 0, 0,
0, 0, 0, 0, 0, -1, 2, -1, 0, 0,
0, 0, 0, 0, 0, 0, -1, 2, -1, 0,
0, 0, 0, 0, 0, 0, 0, -1, 2, -1,
0, 0, 0, 0, 0, 0, 0, 0, -1, 2,
]



split matrix over MPI processes:
Process rank=0 Local Matrix=
[
10,
-1,
0,
0,
0,
0,
0,
0,
0,
0,
]
Process rank=1 Local Matrix=
[
-1,
2,
-1,
0,
0,
0,
0,
0,
0,
0,
]
Process rank=2 Local Matrix=
[
0, 0,
-1, 0,
2, -1,
-1, 2,
0, -1,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
]
Process rank=3 Local Matrix=
[
0,
0,
0,
-1,
2,
-1,
0,
0,
0,
0,
]
Process rank=4 Local Matrix=
[
0, 0,
0, 0,
0, 0,
0, 0,
-1, 0,
2, -1,
-1, 2,
0, -1,
0, 0,
0, 0,
]
Process rank=5 Local Matrix=
[
0,
0,
0,
0,
0,
0,
-1,
2,
-1,
0,
]
Process rank=6 Local Matrix=
[
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
-1, 0,
2, -1,
-1, 2,
]



=============== Testing resize ===============
modified full matrix:
[
1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
]



split matrix over MPI processes:
Process rank=0 Local Matrix=
[
1,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
]
Process rank=1 Local Matrix=
[
0, 0,
1, 0,
0, 1,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
]
Process rank=2 Local Matrix=
[
0,
0,
0,
1,
0,
0,
0,
0,
0,
0,
0,
]
Process rank=3 Local Matrix=
[
0, 0,
0, 0,
0, 0,
0, 0,
1, 0,
0, 1,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
]
Process rank=4 Local Matrix=
[
0,
0,
0,
0,
0,
0,
1,
0,
0,
0,
0,
]
Process rank=5 Local Matrix=
[
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
1, 0,
0, 1,
0, 0,
0, 0,
]
Process rank=6 Local Matrix=
[
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
0, 0,
1, 0,
0, 1,
]



=============== Testing matrix vector multiplication ===============
Matmul between:
[
2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2,
]
and
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
=
[2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2]



=============== Testing iterative linear solver ===============
Linear solver between:
[
2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2,
]
and
[2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2]
=
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
Error norm: 0
Solver return code: 0



=============== Testing direct linear solver ===============
Linear solver between:
[
2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2,
]
and
[2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2]
=
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
Error norm: 0
Solver return code: 0



=============== Testing iterative linear solver ===============
Problem size: 200
Error norm: 5.55954e-14
Solver return code: 0


===================================================================
=                        SPARSE MATRIX DEMO                       =
===================================================================
=============== Testing file load and MPI split ===============
loaded full matrix:
2 -1 0 0 0 0 0 0 0 0
-1 2 -1 0 0 0 0 0 0 0
0 -1 2 -1 0 0 0 0 0 0
0 0 -1 2 -1 0 0 0 0 0
0 0 0 -1 2 -1 0 0 0 0
0 0 0 0 -1 2 -1 0 0 0
0 0 0 0 0 -1 2 -1 0 0
0 0 0 0 0 0 -1 2 -1 0
0 0 0 0 0 0 0 -1 2 -1
0 0 0 0 0 0 0 0 -1 2



split matrix over MPI processes:
Process rank=0 Local Matrix=
2
-1
0
0
0
0
0
0
0
0



=============== Testing modification ===============
modified full matrix:
10 -1 0 0 0 0 0 0 0 0
-1 2 -1 0 0 0 0 0 0 0
0 -1 2 -1 0 0 0 0 0 0
0 0 -1 2 -1 0 0 0 0 0
0 0 0 -1 2 -1 0 0 0 0
0 0 0 0 -1 2 -1 0 0 0
0 0 0 0 0 -1 2 -1 0 0
0 0 0 0 0 0 -1 2 -1 0
0 0 0 0 0 0 0 -1 2 -1
0 0 0 0 0 0 0 0 -1 2



split matrix over MPI processes:
Process rank=0 Local Matrix=
10
-1
0
0
0
0
0
0
0
0
Process rank=1 Local Matrix=
-1
2
-1
0
0
0
0
0
0
0
Process rank=1 Local Matrix=
-1
2
-1
0
0
0
0
0
0
0
Process rank=2 Local Matrix=
0 0
-1 0
2 -1
-1 2
0 -1
0 0
0 0
0 0
0 0
0 0
Process rank=2 Local Matrix=
0 0
-1 0
2 -1
-1 2
0 -1
0 0
0 0
0 0
0 0
0 0
Process rank=3 Local Matrix=
0
0
0
-1
2
-1
0
0
0
0
Process rank=4 Local Matrix=
0 0
0 0
0 0
0 0
-1 0
2 -1
-1 2
0 -1
0 0
0 0
Process rank=5 Local Matrix=
0
0
0
0
0
0
-1
2
-1
0
Process rank=6 Local Matrix=
0 0
0 0
0 0
0 0
0 0
0 0
0 0
-1 0
2 -1
-1 2
Process rank=3 Local Matrix=
0
0
0
-1
2
-1
0
0
0
0
Process rank=3 Local Matrix=
0 0
0 0
0 0
0 0
1 0
0 1
0 0
0 0
0 0
0 0
0 0
Process rank=4 Local Matrix=
0 0
0 0
0 0
0 0
-1 0
2 -1
-1 2
0 -1
0 0
0 0
Process rank=4 Local Matrix=
0
0
0
0
0
0
1
0
0
0
0
Process rank=5 Local Matrix=
0
0
0
0
0
0
-1
2
-1
0
Process rank=5 Local Matrix=
0 0
0 0
0 0
0 0
0 0
0 0
0 0
1 0
0 1
0 0
0 0
Process rank=6 Local Matrix=
0 0
0 0
0 0
0 0
0 0
0 0
0 0
-1 0
2 -1
-1 2
Process rank=6 Local Matrix=
0 0
0 0
0 0
0 0
0 0
0 0
0 0
0 0
0 0
1 0
0 1



=============== Testing resize ===============
modified full matrix (11 x 11):
1 0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0 0
0 0 1 0 0 0 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0 0
0 0 0 0 0 1 0 0 0 0 0
0 0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 0 0 1 0 0
0 0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 0 0 0 1



split matrix over MPI processes:
Process rank=0 Local Matrix=
1
0
0
0
0
0
0
0
0
0
0



=============== Testing matrix vector multiplication ===============
Matmul between:
2 0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0 0
0 0 1 0 0 0 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0 0
0 0 0 0 0 1 0 0 0 0 0
0 0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 0 0 1 0 0
0 0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 0 0 0 2
and
1
1
1
1
1
1
1
1
1
1
1
=
2
1
1
1
1
1
1
1
1
1
2



=============== Testing CG iterative linear solver ===============
Linear solver between:
2 0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0 0
0 0 1 0 0 0 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0 0
0 0Process rank=1 Local Matrix=
0 0
1 0
0 1
0 0
0 0
0 0
0 0
0 0
0 0
0 0
0 0
Process rank=2 Local Matrix=
0
0
0
1
0
0
0
0
0
0
0
0 0 0 1 0 0 0 0 0
0 0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 0 0 1 0 0
0 0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 0 0 0 2
and
2
1
1
1
1
1
1
1
1
1
2
=
1
1
1
1
1
1
1
1
1
1
1
Error norm: 0
Solver return code: 0



=============== Testing direct linear solver ===============
Linear solver between:
2 0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0 0
0 0 1 0 0 0 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0 0
0 0 0 0 0 1 0 0 0 0 0
0 0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 0 0 1 0 0
0 0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 0 0 0 2
and
2
1
1
1
1
1
1
1
1
1
2
=
1
1
1
1
1
1
1
1
1
1
1
Error norm: 0
Solver return code: 0



=============== Testing CG iterative linear solver ===============
Problem size: 1000
Error norm: 9.27171e-13
Iterations: 500
Solver return code: 0




=============== Testing GMRES iterative linear solver ===============
Problem size: 886
Error norm: 3.45365e-07
Iterations: 413
Solver return code: 0



=============== Testing SPAI_GMRES iterative linear solver ===============
Problem size: 886
Error norm: 1.75057e-07
Iterations: 31
Solver return code: 0
