<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>apsc Linear Algebra Language: preconditioners/parallel/spai/update_qr.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">apsc Linear Algebra Language
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e33334e286e5f469a7336f76a5ca2195.html">preconditioners</a></li><li class="navelem"><a class="el" href="dir_f426f4fac369750129d8c8be750b1e4b.html">parallel</a></li><li class="navelem"><a class="el" href="dir_7f9fb91585ffb2484a10ea8487fba2e1.html">spai</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">update_qr.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file containing a QR factorisation updater for SPAI.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;cstdio&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;cstring&gt;</code><br />
<code>#include &quot;<a class="el" href="CSC_8hpp_source.html">CSC.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="assert_8hpp_source.html">assert.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="least__square__solver_8hpp_source.html">least_square_solver.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="permutation_8hpp_source.html">permutation.hpp</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for update_qr.hpp:</div>
<div class="dyncontent">
<div class="center"><img src="update__qr_8hpp__incl.png" border="0" usemap="#preconditioners_2parallel_2spai_2update__qr_8hpp" alt=""/></div>
<map name="preconditioners_2parallel_2spai_2update__qr_8hpp" id="preconditioners_2parallel_2spai_2update__qr_8hpp">
<area shape="rect" title="Header file containing a QR factorisation updater for SPAI." alt="" coords="265,5,441,47"/>
<area shape="rect" title=" " alt="" coords="441,169,512,196"/>
<area shape="rect" title=" " alt="" coords="5,251,68,278"/>
<area shape="rect" title=" " alt="" coords="183,251,245,278"/>
<area shape="rect" title=" " alt="" coords="269,251,335,278"/>
<area shape="rect" title=" " alt="" coords="359,251,426,278"/>
<area shape="rect" href="CSC_8hpp.html" title="Header file containing the CSC struct for compressed sparse column (CSC) matrix representation." alt="" coords="919,169,995,196"/>
<area shape="rect" href="assert_8hpp.html" title="Header file containing a definition of an assertion macro." alt="" coords="450,251,541,278"/>
<area shape="rect" href="least__square__solver_8hpp.html" title="Header file containing a least square solver." alt="" coords="610,95,789,121"/>
<area shape="rect" href="permutation_8hpp.html" title="Header file containing a method to create permutation matrices for SPAI." alt="" coords="134,169,265,196"/>
<area shape="rect" title=" " alt="" coords="1159,251,1218,278"/>
<area shape="rect" title=" " alt="" coords="1243,251,1313,278"/>
<area shape="rect" title=" " alt="" coords="1338,251,1445,278"/>
<area shape="rect" title=" " alt="" coords="878,333,945,360"/>
<area shape="rect" title=" " alt="" coords="927,251,986,278"/>
<area shape="rect" href="EigenStructureMap_8hpp.html" title="Header file containing the EigenStructureMap class for mapping custom data to Eigen structures." alt="" coords="679,251,853,278"/>
<area shape="rect" title=" " alt="" coords="1010,244,1135,285"/>
<area shape="rect" title=" " alt="" coords="540,333,643,360"/>
<area shape="rect" title=" " alt="" coords="667,333,737,360"/>
<area shape="rect" title=" " alt="" coords="761,333,853,360"/>
<area shape="rect" title=" " alt="" coords="435,333,515,360"/>
<area shape="rect" title=" " alt="" coords="775,169,843,196"/>
<area shape="rect" title=" " alt="" coords="537,169,603,196"/>
<area shape="rect" title=" " alt="" coords="628,169,699,196"/>
<area shape="rect" title=" " alt="" coords="93,251,159,278"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="update__qr_8hpp__dep__incl.png" border="0" usemap="#preconditioners_2parallel_2spai_2update__qr_8hppdep" alt=""/></div>
<map name="preconditioners_2parallel_2spai_2update__qr_8hppdep" id="preconditioners_2parallel_2spai_2update__qr_8hppdep">
<area shape="rect" title="Header file containing a QR factorisation updater for SPAI." alt="" coords="5,5,181,47"/>
<area shape="rect" href="spai_8hpp.html" title="Header file for the SPAI class." alt="" coords="5,95,181,136"/>
<area shape="rect" href="apsc__language_8hpp.html" title="Header file defining apsc custom linear algebra language. It aims to ease the developer experience wh..." alt="" coords="17,184,170,225"/>
</map>
</div>
</div>
<p><a href="update__qr_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad03e3ec4457af1897661df3a3dbe3c24"><td class="memTemplParams" colspan="2">template&lt;typename Scalar , typename FullMatrix &gt; </td></tr>
<tr class="memitem:ad03e3ec4457af1897661df3a3dbe3c24"><td class="memTemplItemLeft" align="right" valign="top">int&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="update__qr_8hpp.html#ad03e3ec4457af1897661df3a3dbe3c24">apsc::LinearAlgebra::Preconditioners::ApproximateInverse::Utils::update_QR</a> (struct CSC&lt; Scalar &gt; *A, Scalar **AHat, Scalar **Q, Scalar **R, int **I, int **J, int **sortedJ, int *ITilde, int *JTilde, int *IUnion, int *JUnion, int n1, int n2, int n1Tilde, int n2Tilde, int n1Union, int n2Union, Scalar **m_kOut, Scalar *residual, Scalar *residualNorm, int k)</td></tr>
<tr class="memdesc:ad03e3ec4457af1897661df3a3dbe3c24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update QR factorization for least squares problem.  <a href="update__qr_8hpp.html#ad03e3ec4457af1897661df3a3dbe3c24">More...</a><br /></td></tr>
<tr class="separator:ad03e3ec4457af1897661df3a3dbe3c24"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file containing a QR factorisation updater for SPAI. </p>
<dl class="section author"><dt>Author</dt><dd>Kaixi Matteo Chen </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad03e3ec4457af1897661df3a3dbe3c24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad03e3ec4457af1897661df3a3dbe3c24">&#9670;&nbsp;</a></span>update_QR()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar , typename FullMatrix &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int apsc::LinearAlgebra::Preconditioners::ApproximateInverse::Utils::update_QR </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structapsc_1_1LinearAlgebra_1_1CSC.html">CSC</a>&lt; Scalar &gt; *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar **&#160;</td>
          <td class="paramname"><em>AHat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar **&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar **&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>sortedJ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ITilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>JTilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>IUnion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>JUnion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n1Tilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n2Tilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n1Union</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n2Union</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar **&#160;</td>
          <td class="paramname"><em>m_kOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar *&#160;</td>
          <td class="paramname"><em>residual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar *&#160;</td>
          <td class="paramname"><em>residualNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update QR factorization for least squares problem. </p>
<p>This function updates the QR factorization for solving the least squares problem based on the given input matrices and parameters. It computes the QR factorization of the updated matrix and solves the least squares problem to find the new solution vector <code>m_kOut</code>. It also computes the residual and its norm.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Scalar</td><td>The scalar type of the matrices. </td></tr>
    <tr><td class="paramname">FullMatrix</td><td>The full matrix type for Eigen operations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Pointer to the input matrix in CSC format. </td></tr>
    <tr><td class="paramname">AHat</td><td>Pointer to the modified matrix in dense format. </td></tr>
    <tr><td class="paramname">Q</td><td>Pointer to the Q matrix of the QR factorization. </td></tr>
    <tr><td class="paramname">R</td><td>Pointer to the R matrix of the QR factorization. </td></tr>
    <tr><td class="paramname">I</td><td>Pointer to the row indices of the input matrix. </td></tr>
    <tr><td class="paramname">J</td><td>Pointer to the column indices of the input matrix. </td></tr>
    <tr><td class="paramname">sortedJ</td><td>Pointer to the sorted column indices. </td></tr>
    <tr><td class="paramname">ITilde</td><td>Pointer to the modified row indices. </td></tr>
    <tr><td class="paramname">JTilde</td><td>Pointer to the modified column indices. </td></tr>
    <tr><td class="paramname">IUnion</td><td>Pointer to the union of row indices. </td></tr>
    <tr><td class="paramname">JUnion</td><td>Pointer to the union of column indices. </td></tr>
    <tr><td class="paramname">n1</td><td>Number of rows in the input matrix. </td></tr>
    <tr><td class="paramname">n2</td><td>Number of columns in the input matrix. </td></tr>
    <tr><td class="paramname">n1Tilde</td><td>Number of rows in the modified matrix. </td></tr>
    <tr><td class="paramname">n2Tilde</td><td>Number of columns in the modified matrix. </td></tr>
    <tr><td class="paramname">n1Union</td><td>Number of rows in the union matrix. </td></tr>
    <tr><td class="paramname">n2Union</td><td>Number of columns in the union matrix. </td></tr>
    <tr><td class="paramname">m_kOut</td><td>Pointer to store the new solution vector. </td></tr>
    <tr><td class="paramname">residual</td><td>Pointer to store the residual vector. </td></tr>
    <tr><td class="paramname">residualNorm</td><td>Pointer to store the norm of the residual. </td></tr>
    <tr><td class="paramname">k</td><td>Index for computing the residual.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
